(function(c){var a={};a.boot=function(){a.context=c("#playground")[0].getContext("2d");a.width=c("#playground").width();a.height=c("#playground").height();a.gameOver=!0;a.notify("Press S to start",85,135);c(document).keydown(a.keyDown).keyup(a.keyUp)};a.init=function(){a.setLevel(0).setScore(0);a.goLeft=a.goRight=a.speedUp=!1;a.move=a.score=a.intervalID=0;a.gap=5;a.level=1;a.speed=2;a.block=2;a.enemyCount=5;a.position=a.width*a.block/a.enemyCount+a.gap;a.speedUpBy=0.2;a.setArrangements();a.play=!0;
a.drawHero().drawEnemies();c("#playground").css("opacity",1).unbind("click");a.intervalID=setInterval(a.paint,8)};a.keyUp=function(b){switch(b.keyCode){case 37:a.goLeft=!1;break;case 38:a.speedUp=!1;break;case 39:a.goRight=!1}};a.keyDown=function(b){switch(b.keyCode){case 37:a.goLeft=!0;break;case 38:a.speedUp=!0;break;case 39:a.goRight=!0;break;case 80:if(a.play)clearInterval(a.intervalID);else if(!a.gameOver)a.intervalID=setInterval(a.paint,8);a.play=!a.play;break;case 83:a.gameOver&&a.init()}};
a.drawFigure=function(b,c,d,f,g){a.context.beginPath();a.context.rect(b,c,d,f);a.context.fillStyle=g;a.context.fill();a.context.closePath()};a.drawHero=function(){a.drawFigure(a.position,a.height-50,50,50,"#CCC");return this};a.drawEnemies=function(){for(var b=0;b<a.enemyCount;b++)b in a.arrangement||a.drawFigure(Number(1/a.enemyCount)*b*a.width+a.gap,a.move,50,50,"#777");return this};a.paint=function(){a.gameOver=!1;if(a.goRight==!0&&a.width-a.position>Number(1/a.enemyCount)*a.width-a.gap)a.position+=
Number(1/a.enemyCount)*a.width,a.block++,a.goRight=!1;if(a.goLeft==!0&&a.position!=a.gap)a.position-=Number(1/a.enemyCount)*a.width,a.block--,a.goLeft=!1;a.move+=a.speedUp==!0?4*a.speed:a.speed;a.context.clearRect(0,0,a.width,a.height);a.drawHero().drawEnemies();if(a.move>a.height-96&&!(a.block in a.arrangement))a.notify("Press S to restart",150,135),clearInterval(a.intervalID),a.gameOver=!0;else if(a.move>a.height)a.move=0,a.score++,a.score%5==0&&(a.level++,a.speed+=a.speedUpBy,a.setLevel(a.level)),
a.setScore(a.score),a.setArrangements()};a.setScore=function(a){c(".scoreBoard").html('<div class="subtext">Dodges</div>'+a).hide().fadeIn();"chrome"in window&&chrome.browserAction!==void 0&&(chrome.browserAction.setBadgeBackgroundColor({color:[200,0,0,0]}),chrome.browserAction.setBadgeText({text:String(a)}));return this};a.setLevel=function(a){c(".speedMeter").html('<div class="subtext">Level</div>'+a).hide().fadeIn();return this};a.setArrangements=function(){a.arrangement=[];var b=Math.floor(Math.random()*
4),c;do c=Math.floor(Math.random()*4);while(c==b);a.arrangement[b]=a.arrangement[c]=0};a.notify=function(b,e,d){a.context.font="normal normal 19px Georgia";a.context.fillStyle="white";a.context.fillText(b,e,d);a.context.textAlign="center";c("#playground").css("opacity","0.7")};a.boot()})(jQuery);
